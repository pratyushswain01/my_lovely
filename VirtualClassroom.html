<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zenith Classes - UPSChub</title>
    <style>
        /* --- Universal Styles & Variables --- */
        :root {
            --bg-dark-primary: #111827; /* Darkest background */
            --bg-dark-secondary: #1F2937; /* Lighter dark for panels */
            --border-color: #374151;
            --text-primary: #F9FAFB; /* White */
            --text-secondary: #9CA3AF; /* Gray */
            --brand-blue: #3B82F6;
            --brand-blue-hover: #2563EB;
            --red-leave: #DC2626;
            --red-rec: #F87171;
            --green-confirm: #10B981;
        }

        body, html {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-dark-primary);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        * {
            box-sizing: border-box;
        }

        /* --- SVG Icon Styles --- */
        .icon {
            width: 24px;
            height: 24px;
            stroke: currentColor;
            stroke-width: 1.5;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .icon-sm {
            width: 20px;
            height: 20px;
        }
        
        /* --- Lobby Screen --- */
        #lobby {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: linear-gradient(135deg, var(--bg-dark-secondary), var(--bg-dark-primary));
        }

        .lobby-box {
            background-color: var(--bg-dark-secondary);
            padding: 40px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 1px solid var(--border-color);
            max-width: 90%;
        }
        .lobby-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--brand-blue);
            margin: 0 0 10px;
        }
        .lobby-subtitle {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin: 0;
        }
        .lobby-instructor {
            font-size: 1rem;
            color: var(--text-secondary);
            margin: 5px 0 30px;
        }
        .video-preview {
            width: 320px;
            height: 180px;
            background-color: var(--bg-dark-primary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            margin: 0 auto 20px;
            border: 1px dashed var(--border-color);
        }
        .device-check {
            color: var(--green-confirm);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 30px;
            font-weight: 500;
        }
        .join-button {
            background-color: var(--brand-blue);
            color: white;
            font-weight: bold;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s;
        }
        .join-button:hover {
            background-color: var(--brand-blue-hover);
        }

        /* --- Main Class UI --- */
        #class-ui {
            display: none; /* Hidden by default */
            flex-direction: column;
            height: 100vh;
        }

        /* Top Bar */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background-color: var(--bg-dark-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .top-left { display: flex; align-items: center; gap: 15px; }
        .zenith-logo { font-weight: bold; color: var(--brand-blue); font-size: 1.2rem; }
        .class-title { font-weight: 600; }
        .top-right { display: flex; align-items: center; gap: 20px; }
        .timer { background-color: var(--border-color); padding: 4px 8px; border-radius: 4px; font-size: 0.9em; font-variant-numeric: tabular-nums; }
        .rec-indicator { color: var(--red-rec); font-weight: bold; display: flex; align-items: center; gap: 5px;}
        .rec-indicator span { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

        /* Main Content */
        .main-area {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        .video-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 16px;
            gap: 16px;
        }
        .main-video-feed {
            flex: 1;
            background-color: #000;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
        }
        .instructor-label { position: absolute; bottom: 10px; left: 10px; background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 5px; font-size: 0.9em; }
        .participant-thumbnails { display: flex; flex-wrap: wrap; gap: 10px; }
        .thumbnail {
            width: 150px;
            height: 90px;
            background-color: var(--bg-dark-secondary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
        }
        .thumbnail.is-you { border-color: var(--brand-blue); }

        /* Side Panel */
        .side-panel {
            width: 350px;
            background-color: var(--bg-dark-secondary);
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }
        .side-panel-tabs { display: flex; border-bottom: 1px solid var(--border-color); }
        .tab-button {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: color 0.2s, background-color 0.2s;
        }
        .tab-button:hover { background-color: var(--border-color); color: var(--text-primary); }
        .tab-button.active { color: var(--text-primary); border-bottom-color: var(--brand-blue); }
        .side-panel-content { flex: 1; overflow-y: auto; }
        .tab-content { padding: 12px; height: 100%; display: none; flex-direction: column; }
        .tab-content.active { display: flex; }
        
        /* Side Panel Content: Chat */
        .chat-messages { flex-grow: 1; overflow-y: auto; }
        .message { margin-bottom: 12px; }
        .message strong { display: block; font-size: 0.9em; color: var(--text-secondary); margin-bottom: 4px; }
        .message.is-you { text-align: right; }
        .message .bubble { 
            display: inline-block;
            padding: 8px 12px; 
            border-radius: 12px; 
            max-width: 90%;
            text-align: left;
        }
        .message.is-you .bubble { background-color: var(--brand-blue); border-bottom-right-radius: 2px; }
        .message:not(.is-you) .bubble { background-color: var(--border-color); border-bottom-left-radius: 2px; }

        .input-form { display: flex; margin-top: 10px; }
        .input-field {
            flex: 1;
            background: var(--bg-dark-primary);
            border: 1px solid var(--border-color);
            border-right: none;
            border-radius: 5px 0 0 5px;
            padding: 10px;
            color: white;
            outline: none;
        }
        .input-field:focus { border-color: var(--brand-blue); }
        .send-button {
            background: var(--brand-blue);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
            font-weight: 500;
        }
        
        /* Side Panel Content: Q&A */
        .qna-list { flex-grow: 1; display: flex; flex-direction: column; gap: 10px; }
        .question-item { background: var(--border-color); padding: 10px; border-radius: 8px; display: flex; gap: 10px; align-items: flex-start; }
        .question-upvote { display: flex; flex-direction: column; align-items: center; }
        .upvote-button { background: none; border: 1px solid var(--text-secondary); color: var(--text-secondary); border-radius: 50%; width: 32px; height: 32px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .upvote-button:hover { background-color: #4b556350; color: white; border-color: white;}
        .upvote-count { font-size: 0.9em; margin-top: 4px; font-weight: bold; }
        .question-body p { margin: 0 0 5px; }
        .question-body small { color: var(--text-secondary); }

        /* Side Panel Content: Notes */
        .notes-info { font-size: 0.8rem; color: var(--text-secondary); margin: 0 0 10px 0; padding: 10px; background: #00000020; border-radius: 5px;}
        .notes-textarea { flex: 1; width: 100%; background: var(--bg-dark-primary); border: 1px solid var(--border-color); color: white; border-radius: 5px; padding: 10px; resize: none; font-family: inherit; font-size: 1rem; }
        
        /* Side Panel Content: Resources */
        .resources-list { display: flex; flex-direction: column; gap: 10px; }
        .resource-link { display: flex; align-items: center; gap: 10px; background: var(--border-color); padding: 12px; border-radius: 8px; color: var(--brand-blue); text-decoration: none; transition: background-color 0.2s; }
        .resource-link:hover { background-color: #4B5563; }

        /* Bottom Control Bar */
        .control-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: var(--bg-dark-secondary);
            border-top: 1px solid var(--border-color);
        }
        .control-group { display: flex; gap: 8px; }
        .control-button {
            background-color: var(--border-color);
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            width: 80px;
            height: 60px;
            justify-content: center;
            border-radius: 8px;
            font-size: 0.75rem;
            transition: background-color 0.2s, color 0.2s;
        }
        .control-button:hover { background-color: #4B5563; }
        .control-button.is-active { color: var(--brand-blue); }
        .control-button[disabled] { color: #6B7280; background-color: #374151; cursor: not-allowed; }
        .control-button.leave-button { background-color: var(--red-leave); }
        .control-button.leave-button:hover { background-color: #b91c1c; }
    </style>
</head>
<body>

    <!-- LOBBY SCREEN (Visible by default) -->
    <div id="lobby">
        <div class="lobby-box">
            <h1 class="lobby-title">Zenith Classes</h1>
            <p class="lobby-subtitle" id="lobby-class-title"></p>
            <p class="lobby-instructor" id="lobby-instructor-name"></p>
            
            <div class="video-preview">
                <svg class="icon" style="width: 48px; height: 48px; color: var(--text-secondary);" viewBox="0 0 24 24"><path d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M12 18.75h-9a2.25 2.25 0 01-2.25-2.25v-9A2.25 2.25 0 012.25 4.5h9.613a.75.75 0 01.597.28l.25.501M5.25 6.75l-1.5 3m0 0l1.5 3m-1.5-3h3.75m10.5 0v.75m-.75-.75h.75m-3 3h3"></path></svg>
            </div>
            
            <div class="device-check">
                <svg class="icon" viewBox="0 0 24 24"><path d="M12 18.75a6 6 0 006-6v-1.5a6 6 0 00-12 0v1.5a6 6 0 006 6zM21 12a9 9 0 11-18 0a9 9 0 0118 0z"></path></svg>
                <span>Microphone & Camera OK</span>
            </div>
            
            <button id="join-class-btn" class="join-button">Join Class Now</button>
        </div>
    </div>

    <!-- MAIN CLASS UI (Hidden by default) -->
    <div id="class-ui">
        <!-- Top Bar -->
        <header class="top-bar">
            <div class="top-left">
                <span class="zenith-logo">Zenith</span>
                <span class="class-title" id="main-class-title"></span>
            </div>
            <div class="top-right">
                <span id="timer" class="timer">00:00:00</span>
                <span class="rec-indicator"><span>🔴</span> REC</span>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-area">
            <div class="video-container">
                <div class="main-video-feed">
                    <p style="font-size: 1.5rem;">Instructor Screen Share</p>
                    <small style="color: var(--text-secondary)">(Content Area)</small>
                    <div class="instructor-label" id="main-instructor-name"></div>
                </div>
                <div class="participant-thumbnails">
                    <div class="thumbnail is-you">You</div>
                    <div class="thumbnail">Rahul V.</div>
                    <div class="thumbnail">Priya K.</div>
                    <div class="thumbnail">Amit S.</div>
                </div>
            </div>
            
            <!-- Interactive Side Panel -->
            <aside class="side-panel">
                <div class="side-panel-tabs">
                    <button class="tab-button active" data-tab="chat">
                        <svg class="icon" viewBox="0 0 24 24"><path d="M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <span>Chat</span>
                    </button>
                    <button class="tab-button" data-tab="qna">
                        <svg class="icon" viewBox="0 0 24 24"><path d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"></path></svg>
                        <span>Q&A</span>
                    </button>
                    <button class="tab-button" data-tab="notes">
                         <svg class="icon" viewBox="0 0 24 24"><path d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>
                        <span>Notes</span>
                    </button>
                    <button class="tab-button" data-tab="resources">
                        <svg class="icon" viewBox="0 0 24 24"><path d="M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m7.693-7.693l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32"></path></svg>
                        <span>Resources</span>
                    </button>
                </div>
                <div class="side-panel-content">
                    <!-- Chat Tab -->
                    <div id="tab-content-chat" class="tab-content active">
                        <div class="chat-messages" id="chat-messages-container"></div>
                        <form id="chat-form" class="input-form">
                            <input id="chat-input" class="input-field" type="text" placeholder="Type a message..." autocomplete="off">
                            <button type="submit" class="send-button">Send</button>
                        </form>
                    </div>
                    <!-- Q&A Tab -->
                    <div id="tab-content-qna" class="tab-content">
                         <div class="qna-list" id="qna-list-container"></div>
                         <form id="qna-form" class="input-form">
                            <input id="qna-input" class="input-field" type="text" placeholder="Ask a question..." autocomplete="off">
                            <button type="submit" class="send-button">Ask</button>
                        </form>
                    </div>
                    <!-- Notes Tab -->
                    <div id="tab-content-notes" class="tab-content">
                        <p class="notes-info">Your private notes are saved automatically.</p>
                        <textarea id="notes-textarea" class="notes-textarea" placeholder="Start typing your private notes here..."></textarea>
                    </div>
                    <!-- Resources Tab -->
                    <div id="tab-content-resources" class="tab-content">
                        <div class="resources-list" id="resources-list-container"></div>
                    </div>
                </div>
            </aside>
        </main>

        <!-- Bottom Control Bar -->
        <footer class="control-bar">
            <div class="control-group">
                <button id="mic-btn" class="control-button is-active"></button>
                <button id="video-btn" class="control-button is-active"></button>
            </div>
             <div class="control-group">
                <button class="control-button" disabled>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M9 17.25v1.007a3 3 0 01-.375.908l-1.5 2.25a.75.75 0 01-1.25-.608V16.5a.75.75 0 00-.75-.75h-3.375a.75.75 0 01-.75-.75V7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v3.75m0 0V6.375a2.25 2.25 0 00-2.25-2.25H4.125A2.25 2.25 0 001.875 6.375v8.25c0 1.24 1.01 2.25 2.25 2.25h3.375"></path></svg>
                    <span>Share</span>
                </button>
                 <button id="hand-raise-btn" class="control-button"></button>
            </div>
            <div class="control-group">
                <button id="leave-btn" class="control-button leave-button">
                    <span>Leave</span>
                </button>
            </div>
        </footer>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- STATE & MOCK DATA ---
            const classDetails = {
                title: "Modern History - The Revolt of 1857",
                instructor: "Dr. Ananya Sharma",
            };
            
            let state = {
                micOn: true,
                videoOn: true,
                handRaised: false,
                timerInterval: null,
                classDuration: 0,
            };

            let data = {
                chat: [
                    { sender: "Instructor", text: "Welcome to Zenith Classes! We will begin shortly." },
                    { sender: "You", text: "Hello Ma'am, audio is clear." }
                ],
                qna: [
                    { id: 1, text: "Can you please explain the 'Doctrine of Lapse' again?", upvotes: 5, user: "Priya K." },
                    { id: 2, text: "What were the immediate economic consequences of the revolt?", upvotes: 2, user: "Amit S." },
                ],
                resources: [
                    { title: "Today's Presentation PDF", url: "#" },
                    { title: "Mind Map of 1857 Revolt", url: "#" },
                    { title: "UPSC PYQ on this topic", url: "#" },
                ]
            };

            const ICONS = {
                micOn: `<svg class="icon" viewBox="0 0 24 24"><path d="M12 18.75a6 6 0 006-6v-1.5a6 6 0 00-12 0v1.5a6 6 0 006 6zM21 12a9 9 0 11-18 0a9 9 0 0118 0z"></path></svg>`,
                micOff: `<svg class="icon" viewBox="0 0 24 24"><path d="M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-3L4.5 12m0 0l2.25 2.25M4.5 12l2.25-2.25m0 0l2.25-2.25M7.5 9.75l2.25-2.25M12 18.75a6 6 0 006-6v-1.5a6 6 0 00-12 0v1.5a6 6 0 006 6z"></path></svg>`,
                videoOn: `<svg class="icon" viewBox="0 0 24 24"><path d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z"></path></svg>`,
                videoOff: `<svg class="icon" viewBox="0 0 24 24"><path d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M12 18.75h-9a2.25 2.25 0 01-2.25-2.25v-9A2.25 2.25 0 012.25 4.5h9.613a.75.75 0 01.597.28l.25.501M5.25 6.75l-1.5 3m0 0l1.5 3m-1.5-3h3.75m10.5 0v.75m-.75-.75h.75m-3 3h3"></path></svg>`,
                hand: `<svg class="icon" viewBox="0 0 24 24"><path d="M15.042 21.672L13.684 16.6m0 0l-2.51 2.225.569-9.47 5.227 7.917-3.286-.672zm0 0l-2.51 2.225.569-9.47 5.227 7.917-3.286-.672z"></path></svg>`,
                upvote: `<svg class="icon icon-sm" viewBox="0 0 24 24"><path d="M4.5 15.75l7.5-7.5 7.5 7.5"></path></svg>`,
                link: `<svg class="icon" viewBox="0 0 24 24"><path d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path></svg>`
            };

            // --- DOM Elements ---
            const lobby = document.getElementById('lobby');
            const classUI = document.getElementById('class-ui');
            const joinBtn = document.getElementById('join-class-btn');
            const leaveBtn = document.getElementById('leave-btn');
            const micBtn = document.getElementById('mic-btn');
            const videoBtn = document.getElementById('video-btn');
            const handRaiseBtn = document.getElementById('hand-raise-btn');
            const timerEl = document.getElementById('timer');
            const tabs = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            // --- RENDER FUNCTIONS (Update UI based on state/data) ---
            const renderChat = () => {
                const container = document.getElementById('chat-messages-container');
                container.innerHTML = '';
                data.chat.forEach(msg => {
                    const isYou = msg.sender === 'You';
                    const div = document.createElement('div');
                    div.className = `message ${isYou ? 'is-you' : ''}`;
                    div.innerHTML = `<strong>${msg.sender}</strong><div class="bubble">${msg.text}</div>`;
                    container.appendChild(div);
                });
                container.scrollTop = container.scrollHeight;
            };

            const renderQnA = () => {
                const container = document.getElementById('qna-list-container');
                container.innerHTML = '';
                // Sort by upvotes descending
                const sortedQnA = [...data.qna].sort((a, b) => b.upvotes - a.upvotes);
                sortedQnA.forEach(q => {
                    const div = document.createElement('div');
                    div.className = 'question-item';
                    div.innerHTML = `
                        <div class="question-upvote">
                            <button class="upvote-button" data-id="${q.id}">${ICONS.upvote}</button>
                            <span class="upvote-count">${q.upvotes}</span>
                        </div>
                        <div class="question-body">
                            <p>${q.text}</p>
                            <small>- ${q.user}</small>
                        </div>
                    `;
                    container.appendChild(div);
                });
            };

            const renderResources = () => {
                const container = document.getElementById('resources-list-container');
                container.innerHTML = '';
                data.resources.forEach(res => {
                    const a = document.createElement('a');
                    a.className = 'resource-link';
                    a.href = res.url;
                    a.target = '_blank';
                    a.innerHTML = `${ICONS.link}<span>${res.title}</span>`;
                    container.appendChild(a);
                });
            };

            const updateControlButton = (btn, iconOn, iconOff, textOn, textOff, isOn) => {
                btn.innerHTML = `${isOn ? iconOn : iconOff}<span>${isOn ? textOn : textOff}</span>`;
                btn.classList.toggle('is-active', isOn);
            };
            
            const updateAllControls = () => {
                updateControlButton(micBtn, ICONS.micOn, ICONS.micOff, "Mute", "Unmute", state.micOn);
                updateControlButton(videoBtn, ICONS.videoOn, ICONS.videoOff, "Stop Video", "Start Video", state.videoOn);
                updateControlButton(handRaiseBtn, ICONS.hand, ICONS.hand, "Lower Hand", "Raise Hand", state.handRaised);
            };

            const formatTime = (seconds) => {
                const h = String(Math.floor(seconds / 3600)).padStart(2, '0');
                const m = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
                const s = String(seconds % 60).padStart(2, '0');
                return `${h}:${m}:${s}`;
            };
            
            const startTimer = () => {
                if (state.timerInterval) clearInterval(state.timerInterval);
                state.timerInterval = setInterval(() => {
                    state.classDuration++;
                    timerEl.textContent = formatTime(state.classDuration);
                }, 1000);
            };

            // --- EVENT LISTENERS ---
            joinBtn.addEventListener('click', () => {
                lobby.style.display = 'none';
                classUI.style.display = 'flex';
                state.classDuration = 0;
                timerEl.textContent = formatTime(0);
                startTimer();
                console.log("EVENT: Joined class");
            });

            leaveBtn.addEventListener('click', () => {
                classUI.style.display = 'none';
                lobby.style.display = 'flex';
                clearInterval(state.timerInterval);
                state.timerInterval = null;
                console.log("EVENT: Left class");
            });

            micBtn.addEventListener('click', () => {
                state.micOn = !state.micOn;
                updateAllControls();
                console.log(`EVENT: Mic toggled ${state.micOn ? 'ON' : 'OFF'}`);
            });
            
            videoBtn.addEventListener('click', () => {
                state.videoOn = !state.videoOn;
                updateAllControls();
                console.log(`EVENT: Video toggled ${state.videoOn ? 'ON' : 'OFF'}`);
            });

            handRaiseBtn.addEventListener('click', () => {
                state.handRaised = !state.handRaised;
                updateAllControls();
                console.log(`EVENT: Hand ${state.handRaised ? 'RAISED' : 'LOWERED'}`);
            });

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetTab = tab.dataset.tab;
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    tabContents.forEach(c => c.classList.remove('active'));
                    document.getElementById(`tab-content-${targetTab}`).classList.add('active');
                });
            });

            document.getElementById('chat-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const input = document.getElementById('chat-input');
                if (input.value.trim()){
                    data.chat.push({ sender: 'You', text: input.value.trim() });
                    renderChat();
                    input.value = '';
                }
            });

            document.getElementById('qna-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const input = document.getElementById('qna-input');
                if (input.value.trim()){
                    data.qna.push({ id: Date.now(), text: input.value.trim(), upvotes: 0, user: 'You' });
                    renderQnA();
                    input.value = '';
                }
            });

            document.getElementById('qna-list-container').addEventListener('click', (e) => {
                const upvoteBtn = e.target.closest('.upvote-button');
                if (upvoteBtn) {
                    const questionId = parseInt(upvoteBtn.dataset.id, 10);
                    const question = data.qna.find(q => q.id === questionId);
                    if (question) {
                        question.upvotes++;
                        renderQnA();
                    }
                }
            });
            
            // --- INITIALIZATION ---
            function init() {
                // Populate static details
                document.getElementById('lobby-class-title').textContent = classDetails.title;
                document.getElementById('lobby-instructor-name').textContent = `with ${classDetails.instructor}`;
                document.getElementById('main-class-title').textContent = classDetails.title;
                document.getElementById('main-instructor-name').textContent = classDetails.instructor;

                // Initial render of dynamic content
                renderChat();
                renderQnA();
                renderResources();
                updateAllControls();

                console.log("Zenith Classes UI Initialized.");
            }
            
            init();
        });
    </script>

</body>
</html>
